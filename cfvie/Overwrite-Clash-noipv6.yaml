mixed-port: 7890
allow-lan: true
bind-address: "*"
ipv6: false
mode: rule
log-level: info
external-controller: 0.0.0.0:9090

dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  use-hosts: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16

  # Fake-IP æè‡´è¿‡æ»¤
  fake-ip-filter:
    - '*.lan'
    - '*.local'
    - localhost
    - 'connectivitycheck.gstatic.com'
    - '*.msftconnecttest.com'
    - '*.msftncsi.com'
    - '*.ntp.org'
    - '*.pool.ntp.org'
    - 'time*.apple.com'
    - 'router.asus.com'
    - '*.miwifi.com'
    - '*.tplinkwifi.net'
    - '*.tracker.*'
    - '*.announce.*'
    - '*.bittorrent.com'

  # å›½å†…å¤– DNS åŒåˆ†æµ
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

  nameserver-policy:
    "geosite:cn":
      - https://dns.alidns.com/dns-query
      - https://doh.pub/dns-query

  "geosite:geolocation-!cn":
      - https://cloudflare-dns.com/dns-query
      - https://dns.google/dns-query

  fallback:
    - https://cloudflare-dns.com/dns-query
    - https://dns.google/dns-query
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4


proxy-providers:
  provider:
    type: http
    url: "$EN_KEY"
    interval: 3600
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600


proxy-groups:

  - name: ğŸš€ è‡ªåŠ¨é€‰æ‹©ï¼ˆSmartï¼‰
    type: select
    use:
      - provider
    proxies:
      - â™»ï¸ è´Ÿè½½å‡è¡¡
      - âš¡ è‡ªåŠ¨æµ‹é€Ÿ
      - DIRECT

  - name: âš¡ è‡ªåŠ¨æµ‹é€Ÿ
    type: url-test
    use:
      - provider
    url: http://www.gstatic.com/generate_204
    interval: 300

  - name: â™»ï¸ è´Ÿè½½å‡è¡¡
    type: load-balance
    strategy: round-robin
    use:
      - provider
    url: http://www.gstatic.com/generate_204
    interval: 300

  - name: ğŸ“º YouTube
    type: select
    proxies:
      - ğŸš€ è‡ªåŠ¨é€‰æ‹©ï¼ˆSmartï¼‰
      - âš¡ è‡ªåŠ¨æµ‹é€Ÿ

  - name: ğŸ¬ Netflix
    type: select
    proxies:
      - ğŸš€ è‡ªåŠ¨é€‰æ‹©ï¼ˆSmartï¼‰
      - âš¡ è‡ªåŠ¨æµ‹é€Ÿ

  - name: ğŸ­ Disney+
    type: select
    proxies:
      - ğŸš€ è‡ªåŠ¨é€‰æ‹©ï¼ˆSmart)


  - name: ğŸ¯ å…¨çƒç›´è¿
    type: select
    proxies:
      - DIRECT

  - name: ğŸŒ å›½å¤–æµé‡
    type: select
    proxies:
      - ğŸš€ è‡ªåŠ¨é€‰æ‹©ï¼ˆSmartï¼‰
      - âš¡ è‡ªåŠ¨æµ‹é€Ÿ
      - â™»ï¸ è´Ÿè½½å‡è¡¡

  - name: ğŸ§² BT ä¸‹è½½
    type: select
    proxies:
      - DIRECT
      - ğŸš€ è‡ªåŠ¨é€‰æ‹©ï¼ˆSmart)



rule-providers:

  geosite-cn:
    type: http
    behavior: domain
    path: ./ruleset/geosite-cn.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite-cn.yaml
    interval: 86400

  geoip-cn:
    type: http
    behavior: ipcidr
    path: ./ruleset/geoip-cn.yaml
    url: https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geoip-cn.yaml
    interval: 86400

  cn-media:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/cn-media.yaml
    path: ./ruleset/cn-media.yaml
    interval: 86400

  youtube:
    type: http
    behavior: domain
    path: ./ruleset/youtube.yaml
    url: https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/youtube.yaml
    interval: 86400

  netflix:
    type: http
    behavior: domain
    path: ./ruleset/netflix.yaml
    url: https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/netflix.yaml
    interval: 86400

  disney:
    type: http
    behavior: domain
    path: ./ruleset/disney.yaml
    url: https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/disney.yaml
    interval: 86400


rules:

  # BT ä¸‹è½½è®¾å¤‡ç›´è¿ï¼ˆ10.10.1.101ï¼‰
  - SRC-IP-CIDR,10.10.1.101/32,DIRECT
  - DST-PORT,6881-6999,DIRECT
  - DOMAIN-KEYWORD,tracker,DIRECT
  - DOMAIN-KEYWORD,announce,DIRECT
  - DOMAIN-KEYWORD,bittorrent,DIRECT
  - DST-PORT,33445,DIRECT
  - DST-PORT,51413,DIRECT
  - PROTOCOL,BitTorrent,DIRECT

  # GeoASN åˆ†æµ
  - ASN,4134,ğŸ¯ å…¨çƒç›´è¿
  - ASN,4837,ğŸ¯ å…¨çƒç›´è¿
  - ASN,9808,ğŸ¯ å…¨çƒç›´è¿
  - ASN,45102,ğŸ¯ å…¨çƒç›´è¿
  - ASN,4538,ğŸ¯ å…¨çƒç›´è¿
  - ASN,17490,ğŸ¯ å…¨çƒç›´è¿
  - ASN,9304,ğŸ¯ å…¨çƒç›´è¿
  - ASN,10103,ğŸ¯ å…¨çƒç›´è¿
  - ASN,13335,ğŸŒ å›½å¤–æµé‡
  - ASN,15169,ğŸŒ å›½å¤–æµé‡
  - ASN,32934,ğŸŒ å›½å¤–æµé‡
  - ASN,8075,ğŸŒ å›½å¤–æµé‡
  - ASN,16509,ğŸŒ å›½å¤–æµé‡

  # å›½å†…è§†é¢‘
  - RULE-SET,cn-media,ğŸ¯ å…¨çƒç›´è¿

  # å›½å¤–æµåª’ä½“
  - RULE-SET,youtube,ğŸ“º YouTube
  - RULE-SET,netflix,ğŸ¬ Netflix
  - RULE-SET,disney,ğŸ­ Disney+

  # å›½å†…ç›´è¿
  - RULE-SET,geosite-cn,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,geoip-cn,ğŸ¯ å…¨çƒç›´è¿

  # é»˜è®¤ â†’ å›½å¤–æµé‡
  - MATCH,ğŸŒ å›½å¤–æµé‡
